<!DOCTYPE html>
<html lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
  <link rel="mask-icon" href="/favicon.ico" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://zzysay.github.io').hostname,
    root: '/',
    scheme: 'Gemini',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="keywords" content="机器学习,神经网络,CNN,RNN,LSTM">
<meta property="og:type" content="article">
<meta property="og:title" content="神经网络">
<meta property="og:url" content="http://zzysay.github.io/2018/01/23/sml-neural-network/index.html">
<meta property="og:site_name" content="ZZY SAY">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166713554832.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166714102481.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166714102481.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166732763992.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166739208412.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166739513116.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166740295852.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166746830058.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166754014576.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166758063254.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166758345608.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166888671455.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166891283560.png">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166898799170.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167030196805.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166915129929.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166939232739.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166954944043.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166966756355.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166966980497.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166967282178.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166967649556.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166969174380.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166972908293.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166976732255.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166978706104.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167023900793.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167039514705.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167039596696.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167054767233.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167054592843.png">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167055228439.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167057481734.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167063527521.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167066694504.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167077598531.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167093804653.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167107516817.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167118536935.jpg">
<meta property="og:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167126992136.png">
<meta property="og:updated_time" content="2020-03-17T09:07:00.133Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="神经网络">
<meta name="twitter:image" content="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166713554832.jpg">

<link rel="canonical" href="http://zzysay.github.io/2018/01/23/sml-neural-network/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>神经网络 | ZZY SAY</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ZZY SAY</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">All in the Game</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="en">
    <link itemprop="mainEntityOfPage" href="http://zzysay.github.io/2018/01/23/sml-neural-network/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/avatar.png">
      <meta itemprop="name" content="Zhenyu Zhang">
      <meta itemprop="description" content="Technology for survival <br/> and art for life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZZY SAY">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          神经网络
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-01-23 21:42:44" itemprop="dateCreated datePublished" datetime="2018-01-23T21:42:44+08:00">2018-01-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-17 17:07:00" itemprop="dateModified" datetime="2020-03-17T17:07:00+08:00">2020-03-17</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Class-Notes/" itemprop="url" rel="index">
                    <span itemprop="name">Class Notes</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Class-Notes/Statistical-Machine-Learning/" itemprop="url" rel="index">
                    <span itemprop="name">Statistical Machine Learning</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166713554832.jpg" alt=""></p>
<a id="more"></a>
<h2 id="多层感知机"><a href="#多层感知机" class="headerlink" title="多层感知机"></a>多层感知机</h2><h3 id="多层感知机的运算"><a href="#多层感知机的运算" class="headerlink" title="多层感知机的运算"></a>多层感知机的运算</h3><p>多层感知机的含有 $1$ 个数据输入层，$1$ 个以上的隐藏层，$1$ 个数据输出层，各层神经元之间全连接，同一层神经元之间无连接。</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166714102481.jpg" alt=""></p>
<p>信息传播公式：<br>$$ z^{(l)} = W^{(l)}·a^{(l-1)} + b^{(l)} \\<br>a^{(l)} = f_l(z^{(l)})$$</p>
<p>其中：</p>
<ul>
<li>$L$ 代表层数</li>
<li>$n^l$ 代表第 $l$ 层的神经元数量</li>
<li>$f_l(·)$ 表示第 $l$ 层的激活函数</li>
<li>$W^{(l)} \in \mathbb{R}^{n^l\times n^{l-1}}$ 表示第 $l$ 层和第 $l-1$ 层之间的权重矩阵</li>
<li>$b^{(l)} \in \mathbb{R}^{n^l} $ 表示第 $l$ 层和第 $l-1$ 层之间的偏置量</li>
<li>$z^{(l)} \in \mathbb{R}^{n^l} $ 表示第 $l$ 层神经元的状态向量（输入）</li>
<li>$a^{(l)} \in \mathbb{R}^{n^l} $ 表示第 $l$ 层神经元的激活向量（输出）</li>
</ul>
<p>非线性激活函数（包括硬门限阈值函数）是导致神经网络运算非线性的直接原因，如果用线性函数作为激活函数，无论多少层的神经网络会退化成一个线性回归， 不能处理非线性分类任务。</p>
<h3 id="多层感知机的学习"><a href="#多层感知机的学习" class="headerlink" title="多层感知机的学习"></a>多层感知机的学习</h3><p>输出的瞬时（第 $i$ 次）损失： $J(W,b;x^{(i)},y^{(i)})$<br>训练样本上（共 $N$ 个）平均损失：$\sum_{i=1}^N J(W,b;x^{(i)},y^{(i)})$</p>
<p><strong>学习目标</strong>：调整神经元连接权重，使得平均误差能量最小，即最小化损失函数：</p>
<p>$$\sum_{i=1}^N J(W,b;x^{(i)},y^{(i)}) + \frac 1 2 \lambda ||W||_F^2 $$</p>
<p>于是有：<br>$$ W^{(l)} = W^{(l)} - \alpha \frac {\partial J(W,b)} {\partial W^{(l)}} =  W^{(l)} - \alpha \sum_{i=1}^N \left(\frac {\partial J(W,b;x^{(i)},y^{(i)})} {\partial W^{(l)}} \right) \\ b^{(l)} = b^{(l)} - \alpha \frac {\partial J(W,b)} {\partial b^{(l)}} =  b^{(l)} - \alpha \sum_{i=1}^N \left(\frac {\partial J(W,b;x^{(i)},y^{(i)})} {\partial b^{(l)}} \right)$$</p>
<p>对于参数的学习，有两种学习方法，批量学习和在线学习。</p>
<p><strong>批量学习</strong>：共有 $N$ 个样本（一个 $batch$），随机采样 $batch$ 训练样本值，$batch-by-batch$ 地调整权重，优点是梯度向量形式固定，缺点是需要的内存资源大。<br><strong>在线学习</strong>：$sample-by-sample$ 地调整权重，优点是易执行、存储量小、有效解决大规模和困难模式的分类，缺点是学习过程随机、不稳定。</p>
<h3 id="误差反向传播算法"><a href="#误差反向传播算法" class="headerlink" title="误差反向传播算法"></a>误差反向传播算法</h3><h4 id="BP基本思想"><a href="#BP基本思想" class="headerlink" title="BP基本思想"></a>BP基本思想</h4><p>$BP$ 算法全称叫作误差反向传播算法（$Error\;Back\;Propagation$），或者也叫误差逆传播算法，其核心思想为<strong>数据正向传递，误差反向传播</strong>。</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166714102481.jpg" alt=""><br><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166732763992.jpg" alt=""></p>
<p><strong>变量依赖关系</strong><br>由$ z^{(l)} = W^{(l)}·a^{(l-1)} + b^{(l)} ，a^{(l)} = f_l(z^{(l)})$ 得：</p>
<p>$$ z^{(l)} = W^{(l)}·f_l(z^{(l)}) + b^{(l)}$$</p>
<p>可见 $W^{(l)}$ 和 $b^{(l)}$ 都与 $z^{(l)}$ 有关，所以如果能够求取 $z^{(l)}$ 的局部梯度，就可以求出 $W^{(l)}$ 和 $b^{(l)}$ 的梯度。</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166739208412.jpg" alt=""></p>
<p>如下图所示，反向越深的隐层与目标函数之间的变量依赖关系越复杂，使用近似计算的计算复杂度会相当高。</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166739513116.jpg" alt=""></p>
<p>$BP$ 算法通过局部梯度迭代的策略，解决了这一问题：</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166740295852.jpg" alt=""></p>
<h4 id="BP算法过程"><a href="#BP算法过程" class="headerlink" title="BP算法过程"></a>BP算法过程</h4><p>按照 $BP$ 的局部梯度迭代策略，问题也就转化成了已知 $l+1$ 层的局部梯度，求 $l$ 层的局部梯度。</p>
<p>假设 $l+1$ 层的局部梯度是已知的：</p>
<p>$$ \delta_j^{(l+1)} = \frac {\partial L} {\partial z_j^{(l+1)}}$$</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166746830058.jpg" alt=""></p>
<p>由图可知：<br>$$z_j^{(l+1)} = \sum_j a_i^{(l)}w_{ij}^{(l+1)} = \sum_i f_i(z_i^{(l)})w_{ij}^{(l+1)} $$</p>
<p>显然：</p>
<p>$$ \frac {\partial z_j^{(l+1)}} {\partial z_i^{(l)}} =  \frac {\partial z_j^{(l+1)}} {\partial z_i^{(l)}}· \frac {\partial a_i^{(l)}} {\partial z_i^{(l)}} =  f’_i(z_i^{(l)}) w_{ij}^{(l+1)} $$</p>
<p>于是可以得到局部梯度迭代公式：</p>
<p>$$ \delta_i^{(l)} = \sum_{j=1}^m \frac {\partial z_j^{(l+1)}} {\partial z_i^{(l)}} · \frac {\partial L} {\partial z_j^{(l+1)}}  = \sum_{j=1}^m f’_i(z_i^{(l)}) w_{ij}^{(l+1)} \delta_i^{(l+1)} = f’_i(z_i^{(l)}) \sum_{j=1}^m  w_{ij}^{(l+1)} \delta_i^{(l+1)} $$</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166754014576.jpg" width="200" align="middle"></p>
<p>输出层参数的学习：<br><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166758063254.jpg" alt=""></p>
<p>在 $(1)$ 中，$y$ 代表的是感知机的输出，也就是第 $L$ 层的输出，和 $a^{(L)}$ 是等价的。</p>
<p>隐层参数的学习：<br><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166758345608.jpg" alt=""></p>
<p>于是可以得到 $BP$ 算法的流程：</p>
<ol>
<li>数据初始化</li>
<li>$Epoch$ 采样</li>
<li>前向计算</li>
<li>反向梯度计算<br>$$ 输出层：\delta_k^L = f’_k(z_k^L)\frac {\partial L} {\partial y_k} \quad 隐藏层：\delta_k^{(l)} = f’_k(z_k^{(l)}) \sum_{k=1}^m w_{ik}^{(l+1)}\delta_k^{(l+1)} $$</li>
<li>求参数梯度<br>$$ \frac {\partial J} {\partial w_{ik}^{(l)}} = a_i^{(l-1)} \delta_k^{(l)} \quad \frac {\partial J} {\partial b_{ik}^{(l)}} =  \delta_k^{(l)} $$</li>
<li>迭代步骤 $2-5$</li>
</ol>
<h4 id="梯度消失与梯度爆炸"><a href="#梯度消失与梯度爆炸" class="headerlink" title="梯度消失与梯度爆炸"></a>梯度消失与梯度爆炸</h4><p>根据 $BP$ 反向传播的算法，<strong>前面层上的梯度是来自于后面层上梯度的乘积</strong>。当层数达到一定的数量，若激活函数的梯度小于 $1$ 时，就会使前面层的梯度变得很小，更新速度过慢，导致梯度消失。若激活函数的梯度大于 $1$，经过层层迭代，前面的梯度将会成指数级增长，出现梯度爆炸问题。</p>
<p><strong>梯度消失</strong>的一种解决方案是使用 $Relu$ 激活函数替换 $Sigmoid$ 函数，$Relu$ 函数的梯度不会随着 $x$ 的增大而变小，$Sigmoid$ 函数在 $x$ 取值较大时梯度趋近于 $0$。</p>
<p><strong>梯度爆炸</strong>可以使用梯度剪裁的方法来解决：</p>
<ul>
<li>选取一个梯度剪裁的阈值 $clip_norm$（一般选择 $1$）</li>
<li>在计算完每个权重的梯度之后，我们并不像通常那样直接使用这些梯度进行权重更新，而是先求所有权重梯度的平方和 $global_norm$</li>
<li>最后把每个梯度乘以缩放因子 $clip_norm / \max(global_norm, clip_norm)$</li>
</ul>
<h2 id="卷积神经网络"><a href="#卷积神经网络" class="headerlink" title="卷积神经网络"></a>卷积神经网络</h2><p>多层感知机是一种全连接的结构，但又是全连接的网络会存在一定程度的冗余，卷积神经网络（$Convolutional\;Neural\;Network, CNN$）通过<strong>局部连接和权重共享</strong>的方法来实现对多层感知机的共享。</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166888671455.jpg" alt=""></p>
<p>我们可以对通过下图对卷积神经网络的结构有一个直观的认识：</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166891283560.png" alt=""></p>
<h3 id="卷积层"><a href="#卷积层" class="headerlink" title="卷积层"></a>卷积层</h3><p>卷积神经网络中每层卷积层由若干卷积单元组成。卷积运算的目的是<strong>提取输入的不同特征</strong>，第一层卷积层可能只能提取一些低级的特征如边缘、线条和角等层级，更多层的网络能从低级特征中迭代提取更复杂的特征。</p>
<h4 id="一维卷积"><a href="#一维卷积" class="headerlink" title="一维卷积"></a>一维卷积</h4><p>给定一个序列 $x_t, t=1,2,\dots, n$ 和一个过滤器 $f_t,  t=1,2,\dots, m$，卷积结果是：</p>
<p>$$ y_t = \sum_{k=1}^m f_k · x_{t-k+1}$$</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166898799170.jpg" width="w444" align="middle"></p>
<h4 id="二维卷积"><a href="#二维卷积" class="headerlink" title="二维卷积"></a>二维卷积</h4><p>给定一个图像 $x_{ij},1 \le i \le M,1 \le j \le N $ 和一个过滤器 $f_{ij},1 \le i \le m,1 \le j \le n$，卷积结果是：</p>
<p>$$ y_{ij} = \sum_{u=1}^m \sum_{v=1}^n f_{uv} · x_{i-u+1,j-v+1} $$</p>
<p>在二维图像中，卷积意味着区域内像素的加权平均</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167030196805.jpg" alt=""></p>
<h4 id="输出尺度和参数个数"><a href="#输出尺度和参数个数" class="headerlink" title="输出尺度和参数个数"></a>输出尺度和参数个数</h4><p><strong>填充设置</strong><br>填充设置 $Pad$ 是卷积中的另外一个参数，根据填充设置的不同，卷积的结果有窄卷积，等长卷积和宽卷积，通常情况下，填充的内容都为 $0$，在上面的演示中，一维卷积我们使用的是窄卷积，二维卷积我们使用的是等长卷积。<br><strong>窄卷积</strong>：信号两端不补 $0$，输出信号长度为 $N-M+1$<br><strong>宽卷积</strong>：信号两端补 $0$，输出信号长度为 $N+M-1$<br><strong>等长卷积</strong>：信号两端补 $0$，输出信号长度为 $N$</p>
<p><strong>输出尺度</strong></p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166915129929.jpg" alt=""></p>
<p>输入尺度：<br>宽度 $W_1 = 32$<br>高度 $H_1 = 32$<br>深度 $D_1 = 32$<br>输出尺寸：<br>宽度 $W_2 = 1+ (W_1-F_W+2P)/S = 32$<br>高度 $H_2 = 1+ (H_1-F_H+2P)/S = 32$<br>深度 $D_2 = K = 10$<br>其中，$F_W$ 是过滤器宽度，$F_H$ 是过滤器高度，$K$ 是过滤器个数，$P$ 是填充大小，$S$ 是步长。</p>
<p>注：不同的过滤器可能是对不同层采样，也可能使用不同的参数对同一层采样。</p>
<p><strong>参数个数</strong><br><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166939232739.jpg" alt=""></p>
<p>参数个数 $P = (F_W \times F_H \times D_1 + 1) \times K$，其中的 $1$ 表示阈值。</p>
<p>卷积层有一个概念就是权值共享，如没有这个原则，则特征图由 $10$ 个$32\times 32\times 1$ 的特征图组成，即每个特征图上有 $1024$ 个神经元，每个神经元对应输入图像上一块 $5\times 5\times 3$ 的区域，即一个神经元和输入图像的这块区域有 $75$ 个连接，即 $75$ 个权值参数，这是非常复杂的，因此卷积神经网络引入权值共享原则，即一个特征图上每个神经元对应的 $75$ 个权值参数被每个神经元共享，这样则只需 $75\times10=750$ 个权值参数，而每个特征图的阈值也共享，即需要 $10$ 个阈值，则总共需要$750+10=760$ 个参数。</p>
<h3 id="子采样层"><a href="#子采样层" class="headerlink" title="子采样层"></a>子采样层</h3><p>池化（$Pooling$）是卷积神经网络中另一个重要的概念，它实际上是一种形式的<strong>下采样</strong>。当前最大池化（$Max\;Pooling$）是最为常见，它是将输入的图像划分为若干个矩形区域，对每个子区域输出最大值。</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166954944043.jpg" alt=""></p>
<p>直觉上，这种机制能够有效地原因在于，在发现一个特征之后，它的精确位置远不及它和其他特征的相对位置的关系重要。<strong>池化层会不断地减小数据的空间大小，因此参数的数量和计算量也会下降，这在一定程度上也控制了过拟合</strong>。通常来说，$CNN$ 的卷积层之间都会周期性地插入池化层。</p>
<p>池化层通常会分别作用于每个输入的特征并减小其大小。$Max\;Pooling$ 每隔 $2$ 个元素从图像划分出 $2\times 2$ 的区块，然后对每个区块中的 $4$ 个数取最大值，这将会减少百分之七十五的数据量。</p>
<p>除了最大池化之外，池化层也可以使用其他池化函数，例如“平均池化”甚至“$L2$范数池化”等，由于池化层过快地减少了数据的大小，目前文献中的趋势是在池化运算时使用较小的区块，甚至不再使用池化层。</p>
<h2 id="递归神经网络"><a href="#递归神经网络" class="headerlink" title="递归神经网络"></a>递归神经网络</h2><p>递归神经网络（$RNN$）是两种人工神经网络的总称，一种是时间递归神经网络（$Recurrent\;Neural\;Network$，即常说的循环神经网络），另一种是递归神经网络（$Recursive\;Neural\;Network$）。</p>
<h3 id="基本递归结构"><a href="#基本递归结构" class="headerlink" title="基本递归结构"></a>基本递归结构</h3><p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166966756355.jpg" alt=""><br><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166966980497.jpg" alt=""><br><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166967282178.jpg" alt=""><br><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166967649556.jpg" alt=""></p>
<p><strong>通用逼近定理</strong>：如果网络具有充分多的隐藏神经元，任意的非线性动态系统可以由递归神经网络以期望的精度来逼近，对于状态空间的紧致性没有限制。</p>
<ul>
<li><strong>可控和可观测</strong>：递归网络具有局部线性可控和局部可观测性</li>
<li><strong>计算能力</strong>：所有图灵机都可由建立在用 $sigmoid$ 激活函数的神经元上的完全连接递归网络模拟</li>
</ul>
<h3 id="循环神经网络"><a href="#循环神经网络" class="headerlink" title="循环神经网络"></a>循环神经网络</h3><p>循环神经网络类似于上文所述的第二种结构，基本的循环单元如下图所示：</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166969174380.jpg" alt=""></p>
<p>按照时间上延展开：<br><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166972908293.jpg" alt=""></p>
<h4 id="分回合训练"><a href="#分回合训练" class="headerlink" title="分回合训练"></a>分回合训练</h4><p>同样，梯度是反向传播的，问题在于求 $W_a$，$W_b$，$W_c$，其中，$W_a$，$W_b$ 的梯度依赖于局部梯度，$W_a$ 相当于多层感知机的隐层，$W_c$ 相当于输出层。</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166976732255.jpg" alt=""></p>
<p>局部梯度迭代：<br><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15166978706104.jpg" alt=""></p>
<p>采用 $BP$ 算法的思想，显然有：</p>
<p>$$ \delta_k = \frac {\partial L} {\partial v_k} = \frac {\partial\left(\sum_{l=k}^n L(y_l) \right)} {\partial v_k} = \frac {\partial L(y_k)} {\partial v_k} + \frac {\partial\left(\sum_{l=k}^n L(y_l) \right)} {\partial v_k} = \frac {\partial L(y_k)} {\partial v_k} + \frac {\partial v_{k+1}} {\partial v_k}\delta_{k+1} $$</p>
<p>其中：</p>
<p>$$\frac {\partial L(y_k)} {\partial v_k} = \frac {\partial s_k} {\partial v_k}  \frac {\partial y_k} {\partial s_k} \frac {\partial L(y_k)} {\partial y_k} = diag(\sigma’(v_k))W_c^TL’(y_k) $$</p>
<p>$$ \frac {\partial v_{k+1}} {\partial v_k} \delta_{k+1} =  \frac {\partial s_k} {\partial v_k} \frac {\partial v_{k+1}}{\partial s_k} \delta_{k+1} = diag(\sigma’(v_k))W_a^T\delta_{k+1} $$</p>
<p>当 $k = n$ 时<br>$$ \delta_k = \frac {\partial L} {\partial v_k}= \frac {\partial L(y_k)} {\partial v_k} = diag(\sigma’(v_k))W_c^T L’(y_k) $$</p>
<p>当 $k \ne n$ 时<br>$$ \delta_k = \frac {\partial L} {\partial v_k}= \frac {\partial L(y_k)} {\partial v_k} + \frac {\partial s_{k+1}} {\partial v_k} \delta_{k+1} = diag(\sigma’(v_k))(W_c^T L’(y_k)+W_a^T\delta_{k+1}) $$</p>
<p>参数更新：</p>
<p>$$ W_a = W_a - \eta_1 \delta_k \frac {\partial v_k}{\partial W_a} = W_a - \eta_1 \delta_k \sum_{k=1}^n s_{k-1}^T<br>\\ W_b = W_b - \eta_2 \delta_k \frac {\partial v_k}{\partial W_b} = W_b - \eta_2 \delta_k \sum_{k=1}^n x_k^T<br>\\ W_c = W_c - \eta_3 \delta_k \frac {\partial v_k}{\partial W_c} = W_c - \eta_3 \sum_{k=1}^n s_k^T$$</p>
<h4 id="实时递归训练"><a href="#实时递归训练" class="headerlink" title="实时递归训练"></a>实时递归训练</h4><p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167023900793.jpg" alt=""></p>
<h4 id="RNN扩展结构"><a href="#RNN扩展结构" class="headerlink" title="RNN扩展结构"></a>RNN扩展结构</h4><p>$RNN$ 可以较好地处理短依赖关系，但是往往无法较好地处理长时依赖关系，下图所示的是一个标准的 $RNN$ 按时序的延展结构，</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167039514705.jpg" alt=""></p>
<p>在自然语言处理的环境中，有时候只考虑前面的词是远远不够的，于是就出现了<strong>双向循环神经网络</strong>结构：</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167039596696.jpg" alt=""></p>
<p>从上图可以看出，双向卷积神经网络的隐藏层要保存两个值，一个 $A$ 参与正向计算，另一个值 $A’$ 参与反向计算，最终的输出值 $y_n$ 取决于 $A_n$ 和 $A_n’$ 。正向计算时，隐藏层的值与 $s_t$ 和 $s_{t-1}$ 有关；反向计算时，隐藏层的值与 $s_t’$ 和 $s_{t+1}’$ 有关，最终的输出取决于正向和反向计算的加和，正向计算和反向计算的权重矩阵都是不相同的。</p>
<h3 id="长短时记忆神经网络"><a href="#长短时记忆神经网络" class="headerlink" title="长短时记忆神经网络"></a>长短时记忆神经网络</h3><p>如下图所示的是一个传统的 $RNN$ 单元结构，梯度消失和梯度爆炸是传统 $RNN$ 中最为致命的一个缺陷。</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167054767233.jpg" alt=""></p>
<p>在梯度的反向传播过程中，当到达一个梯度几乎为零的阶段 $t$ ，从这个时刻开始再继续往前传播，得到的梯度就不会对最终的梯度值有任何贡献，这就相当于无论 $t$ 之前的网络状态是什么，在训练中都不会对权重数组的更新产生影响，也就是网络事实上已经忽略了 $t$ 时刻之前的状态，这就是原始 $RNN$ 无法处理长距离依赖的原因。</p>
<p>长短时记忆神经网络($Long\; Short-Term\;Memory\;Neural\;Network， LSTM$)是 $RNN$ 的一个变体，可以有效地解决简单循环神经网络的梯度爆炸或消失问题。</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167054592843.png" alt=""><br><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167055228439.jpg" alt=""></p>
<p>$LSTM$ 模型的关键是引入了一组记忆单元($Memory\;Units$)，允许网络可以学习何时遗忘历史信息，何时用新信息更新记忆单元。在时刻 $t$ 时，记忆单元 $c_t$ 记录了到当前时刻为止的所有历史信息，并受三个门控制：输入门 $i_t$, 遗忘门 $f_t$ 和输出门 $o_t$，三个门的元素的值在 $[0,1]$ 之间。</p>
<p>$LSTM$ 中最为核心的就是贯穿整个网络的记忆，也就是细胞的状态，用来记录目前为止的所有历史信息。<br><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167057481734.jpg" alt=""></p>
<p>除此之外，还有门的概念，门由一个 $sigmoid$ 层和一个点乘运算组成，使用 $sigmoid$ 函数意味着要么使信息全部通过，要么阻止全部信息，每个门都可开可关，而且门在每个步骤都会重新组合开关状态。</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167063527521.jpg" width="w100" align="middle"></p>
<p>$\sigma$ 符号表示 $sigmoid$ 激活函数，用于决定什么信息需要遗忘/输入/输出<br>点乘符号来执行遗忘/输入/输出操作，遗忘/输入/输出那些我们在 $sigmoid$ 层决定遗忘/输入/输出的信息</p>
<h4 id="遗忘门"><a href="#遗忘门" class="headerlink" title="遗忘门"></a>遗忘门</h4><p>$LSTM$ 的第一步是决定要丢弃多少历史信息（遗忘细胞中的记忆），遗忘门（$Forget\;Gate$）就是来做这个工作的。它输入 $h_{t−1}$ 和 $x_t$，然后为 $C_{t−1}$ 中的每个神经元生成一个 $0~1$ 之间的数字，$0$ 代表完全丢弃，$1$ 代表完全保留。所以我们期望让它需要记住一些确切的东西时，它可以被完全激活；当不再需要这些信息时，它可以被再次关闭。</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167066694504.jpg" alt=""></p>
<p>符号含义：<br>$f_t$：遗忘门的输出<br>$W_f$：遗忘门的权重矩阵<br>$b_f$：遗忘门的偏移量<br>$h_{t−1}$：$t-1$ 时刻的输出，同时也是 $t$ 时刻的输入<br>$x_t$：$t$ 时刻新输入的内容<br>$\sigma$：$sigmoid$ 激活函数</p>
<p>模拟一个语言模型的场景，在神经元状态或许包括当前主语中的性别信息，所以可以使用正确的代词。当我们看到一个新的主语，我们会去遗忘之前的性别信息。</p>
<h4 id="输入门"><a href="#输入门" class="headerlink" title="输入门"></a>输入门</h4><p>下一步的工作就是我们要决定在决定了是否要在记忆细胞中保存从新输入的信息，这个模块包括两个部分，一个部分是输入门（$Input\;Gate$），决定我们要更新的数值，一个部分创建一个新的候选值，这都是为下一步的状态更新做准备。</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167077598531.jpg" alt=""></p>
<p>符号含义：<br>$i_t$：输入门的输出<br>$W_i$：输入门的权重矩阵<br>$b_i$：输入门的偏移量<br>$h_{t−1}$：$t-1$ 时刻的输出，同时也是 $t$ 时刻的输入<br>$x_t$：$t$ 时刻新输入的内容<br>$\sigma$：$sigmoid$ 激活函数</p>
<p>$\tilde C_t$：新输入的全部信息<br>$W_C$：输入状态的权重矩阵<br>$b_C$：输入状态的偏移量<br>$\tanh$：双曲正切激活函数</p>
<p>在语言模型的例子中，我们想给神经元状态增加新的主语的性别，替换我们将要遗忘的旧主语。</p>
<p>关于激活函数：<br>$sigmoid$ 用在各种门上，产生 $[0,1]$ 之间的值，这个工作只有 $sigmoid$ 可以胜任。<br>$tanh$ 用在状态和输出上，是对数据的处理，产生的是 $[-1,1]$ 之间的值，这个工作使用其他的激活函数或许也可以。</p>
<h4 id="更新记忆"><a href="#更新记忆" class="headerlink" title="更新记忆"></a>更新记忆</h4><p>现在我们来更新记忆细胞中的信息，我们在上一步已经确定了有什么信息需要更新，现在只需要把它们结合到一起。我们给旧的记忆乘以 $f_t$，遗忘掉我们之前决定要遗忘的信息，然后给新的候选记忆 $\tilde C_t$ 乘以 $i_t$，加入我们之前决定要加入的信息，加入的信息量的多少取决于我们决定更新每个状态的程度。</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167093804653.jpg" alt=""></p>
<p>符号含义：<br>$f_t$：遗忘门的输出<br>$C_{t_1}$：上一时刻的全部信息<br>$i_i$：输入门的输出<br>$\tilde C_t$：新输入的全部信息<br>$C_t$：当前时刻的全部信息</p>
<p>在状态更新的时候，$LSTM$ 是用的乘法函数和加法函数结合的方法，所以就不容易出现总梯度逐渐接近 $0$ 的情况，从而解决了 $RNN$ 出现梯度消失，不能进行长时依赖的问题。</p>
<p>在语言模型的例子中，这里就是我们实际上要丢弃旧主语的性别信息，增加新主语性别信息的地方。</p>
<h4 id="输出门"><a href="#输出门" class="headerlink" title="输出门"></a>输出门</h4><p>最后，我们要做的是决定当前环节的输出，首先使用一个输出门（$Output\;Gate$）决定输出细胞状态的哪个部分，接着用 $tanh$ 函数处理细胞状态（使其值域在 $[-1,1]$ 之间），再将其和输出门的输出相乘，输出我们确定要输出的部分。</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167107516817.jpg" alt=""></p>
<p>符号含义：<br>$o_t$：输出门的输出<br>$W_o$：输出门的权重矩阵<br>$b_o$：输出门的偏移量<br>$h_{t−1}$：$t-1$ 时刻的输出，同时也是 $t$ 时刻的输入<br>$x_t$：$t$ 时刻新输入的内容<br>$\sigma$：$sigmoid$ 激活函数</p>
<p>$C_t$：当前时刻的全部信息<br>$h_t$：当前时刻的输出<br>$\tanh$：双曲正切激活函数</p>
<p>在语言模型的例子中，当我们看到一个主语的时候，我们或许想输出相关的动词信息，例如我们可能需要根据单复数信息来输出“他”或者“他们”。</p>
<p>所以在时刻 $t$，$LSTM$ 的更新公式为：</p>
<p>$$ i_t = \sigma(W_ix_t + U_ih_{t-1} + V_ic_{t-1})<br>\\ f_t = \sigma(W_fx_t + U_fh_{t-1} + V_fc_{t-1})<br>\\ o_t = \sigma(W_ox_t + U_oh_{t-1} + V_oc_{t-1})<br>\\ \tilde C_t = tanh(W_Cx_t + U_Ch_{t-1})<br>\\ C_t = f_t · c_{t-1} + i_t · \tilde C_t<br>\\ h_t = o_t · tanh(c_t)$$</p>
<p>这里，$x_t$ 是当前时刻的输入，$\sigma$ 是 $sigmoid$ 函数，$V_i, V_f, V_o$ 是对角矩阵。<br>遗忘门 $f_t$ 控制每一个内存单元需要遗忘多少信息<br>输入门 $i_t$ 控制每一个内存单元加入多少新的信息<br>输出门 $o_t$ 控制每一个内存单元输出多少信息</p>
<h4 id="LSTM变种结构"><a href="#LSTM变种结构" class="headerlink" title="LSTM变种结构"></a>LSTM变种结构</h4><p><strong>Peephole</strong></p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167118536935.jpg" alt=""></p>
<p>加入了窥视孔连接。这意味着门限层也将单元状态作为输入，上图中所有的门限中都加入了窥视孔，但是许多论文都只使用部分窥视孔。</p>
<p><strong>GRU</strong></p>
<p>门限循环单元（$Gated\;Recurrent\;Unit, GRU$）是一种 $LSTM$ 的简化版本。$GRU$ 将输入门与和遗忘门合并成一个门：更新门（$Update\;Gate$），同时还合并了记忆单元 $c_t$ 和神经元活性 $h_t$。</p>
<p><img src="https://zhenyu-1253816923.cos.ap-beijing.myqcloud.com/2020/03/17/15167126992136.png" alt=""></p>
<p>$GRU$ 模型：更新门 $z$ 和重置门 $r$</p>
<ul>
<li>更新门 $z$：用来控制当前的状态需要遗忘多少历史信息和接受多少新信息</li>
<li>重置门 $r$：用来控制候选状态中有多少信息是从历史信息中得到</li>
</ul>
<p>$GRU$ 因为比 $LSTM$ 更加简单，并且效果也没有显著下降，所以现在正在变得越来越流行。</p>
<p>参考文献：<br>[1] 周晓飞,《统计机器学习》,中国科学院大学2017年秋季研究生课程<br>[2] 刘康,《知识图谱导论》,中国科学院大学2017年秋季研究生课程<br>[3] <a href="https://zh.wikipedia.org/wiki/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C" target="_blank" rel="noopener">卷积神经网络-维基百科</a><br>[4] <a href="https://zh.wikipedia.org/wiki/%E9%80%92%E5%BD%92%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C" target="_blank" rel="noopener">递归神经网络-维基百科</a><br>[5] <a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/" target="_blank" rel="noopener">Understanding LSTM Networks-Chris Olah</a></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/机器学习/" rel="tag"># 机器学习</a>
              <a href="/tags/神经网络/" rel="tag"># 神经网络</a>
              <a href="/tags/CNN/" rel="tag"># CNN</a>
              <a href="/tags/RNN/" rel="tag"># RNN</a>
              <a href="/tags/LSTM/" rel="tag"># LSTM</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2018/01/20/sml-graphical-model/" rel="prev" title="概率图模型">
      <i class="fa fa-chevron-left"></i> 概率图模型
    </a></div>
      <div class="post-nav-item">
    <a href="/2018/02/07/ml-em/" rel="next" title="期望最大算法">
      期望最大算法 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#多层感知机"><span class="nav-number">1.</span> <span class="nav-text">多层感知机</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#多层感知机的运算"><span class="nav-number">1.1.</span> <span class="nav-text">多层感知机的运算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多层感知机的学习"><span class="nav-number">1.2.</span> <span class="nav-text">多层感知机的学习</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#误差反向传播算法"><span class="nav-number">1.3.</span> <span class="nav-text">误差反向传播算法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#BP基本思想"><span class="nav-number">1.3.1.</span> <span class="nav-text">BP基本思想</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BP算法过程"><span class="nav-number">1.3.2.</span> <span class="nav-text">BP算法过程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#梯度消失与梯度爆炸"><span class="nav-number">1.3.3.</span> <span class="nav-text">梯度消失与梯度爆炸</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#卷积神经网络"><span class="nav-number">2.</span> <span class="nav-text">卷积神经网络</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#卷积层"><span class="nav-number">2.1.</span> <span class="nav-text">卷积层</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#一维卷积"><span class="nav-number">2.1.1.</span> <span class="nav-text">一维卷积</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#二维卷积"><span class="nav-number">2.1.2.</span> <span class="nav-text">二维卷积</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输出尺度和参数个数"><span class="nav-number">2.1.3.</span> <span class="nav-text">输出尺度和参数个数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#子采样层"><span class="nav-number">2.2.</span> <span class="nav-text">子采样层</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#递归神经网络"><span class="nav-number">3.</span> <span class="nav-text">递归神经网络</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基本递归结构"><span class="nav-number">3.1.</span> <span class="nav-text">基本递归结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#循环神经网络"><span class="nav-number">3.2.</span> <span class="nav-text">循环神经网络</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#分回合训练"><span class="nav-number">3.2.1.</span> <span class="nav-text">分回合训练</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#实时递归训练"><span class="nav-number">3.2.2.</span> <span class="nav-text">实时递归训练</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RNN扩展结构"><span class="nav-number">3.2.3.</span> <span class="nav-text">RNN扩展结构</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#长短时记忆神经网络"><span class="nav-number">3.3.</span> <span class="nav-text">长短时记忆神经网络</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#遗忘门"><span class="nav-number">3.3.1.</span> <span class="nav-text">遗忘门</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入门"><span class="nav-number">3.3.2.</span> <span class="nav-text">输入门</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#更新记忆"><span class="nav-number">3.3.3.</span> <span class="nav-text">更新记忆</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输出门"><span class="nav-number">3.3.4.</span> <span class="nav-text">输出门</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LSTM变种结构"><span class="nav-number">3.3.5.</span> <span class="nav-text">LSTM变种结构</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Zhenyu Zhang"
      src="/avatar.png">
  <p class="site-author-name" itemprop="name">Zhenyu Zhang</p>
  <div class="site-description" itemprop="description">Technology for survival <br/> and art for life</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">34</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zhenyu Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.7.0
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  















  

  
      
<script type="text/x-mathjax-config">

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });

  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') {
          next = next.nextSibling;
        }
        if (next && next.nodeName.toLowerCase() === 'br') {
          next.parentNode.removeChild(next);
        }
      }
    });
  });

  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      element = document.getElementById(all[i].inputID + '-Frame').parentNode;
      if (element.nodeName.toLowerCase() == 'li') {
        element = element.parentNode;
      }
      element.classList.add('has-jax');
    }
  });
</script>
<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML', () => {
    MathJax.Hub.Typeset();
  }, window.MathJax);
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

    

  

</body>
</html>
