<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="公开课笔记," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="理论知识期望最大化算法(EM Algorithm)在前面的若干讲义中，我们已经讲过了期望最大化算法（EM Algorithm），使用场景是对一个高斯混合模型进行拟合。在本章里面，我们要给出期望最大化算法的更广泛应用，并且演示如何应用于一个大系列的具有潜在变量的估计问题。我们的讨论从 Jensen 不等式（Jensen’s inequality）开始，这是一个非常有用的结论    。 Jensen">
<meta name="keywords" content="公开课笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="第十三集 高斯混合模型">
<meta property="og:url" content="http://zzysay.github.io/2017/08/21/cs229-13/index.html">
<meta property="og:site_name" content="ZZY SAY">
<meta property="og:description" content="理论知识期望最大化算法(EM Algorithm)在前面的若干讲义中，我们已经讲过了期望最大化算法（EM Algorithm），使用场景是对一个高斯混合模型进行拟合。在本章里面，我们要给出期望最大化算法的更广泛应用，并且演示如何应用于一个大系列的具有潜在变量的估计问题。我们的讨论从 Jensen 不等式（Jensen’s inequality）开始，这是一个非常有用的结论    。 Jensen">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img001.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img002.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img003.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img004.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img005.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img006.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img007.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img008.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img009.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img011.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img012.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img013.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img014.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img015.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img017.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img018.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img019.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img020.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img021.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img023.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img024.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img025.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img027.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img028.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img029.jpg?imageMogr2/thumbnail/!66p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note9-img001.jpg?imageMogr2/thumbnail/!50p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note9-img002.jpg?imageMogr2/thumbnail/!75p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note9-img003.jpg?imageMogr2/thumbnail/!75p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note9-img004.jpg?imageMogr2/thumbnail/!75p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note9-img005.jpg?imageMogr2/thumbnail/!75p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note9-img006.jpg?imageMogr2/thumbnail/!75p">
<meta property="og:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note9-img007.jpg?imageMogr2/thumbnail/!75p">
<meta property="og:updated_time" content="2017-08-23T05:30:40.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第十三集 高斯混合模型">
<meta name="twitter:description" content="理论知识期望最大化算法(EM Algorithm)在前面的若干讲义中，我们已经讲过了期望最大化算法（EM Algorithm），使用场景是对一个高斯混合模型进行拟合。在本章里面，我们要给出期望最大化算法的更广泛应用，并且演示如何应用于一个大系列的具有潜在变量的估计问题。我们的讨论从 Jensen 不等式（Jensen’s inequality）开始，这是一个非常有用的结论    。 Jensen">
<meta name="twitter:image" content="http://otceoztx6.bkt.clouddn.com/cs229-note8-img001.jpg?imageMogr2/thumbnail/!66p">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://zzysay.github.io/2017/08/21/cs229-13/"/>





  <title>第十三集 高斯混合模型 | ZZY SAY</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ZZY SAY</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">All in the Game</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://zzysay.github.io/2017/08/21/cs229-13/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhenyu Zhang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZZY SAY">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">第十三集 高斯混合模型</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-21T12:52:18+08:00">
                2017-08-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/机器学习/" itemprop="url" rel="index">
                    <span itemprop="name">机器学习</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/机器学习/Andrew-Ng公开课/" itemprop="url" rel="index">
                    <span itemprop="name">Andrew Ng公开课</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="理论知识"><a href="#理论知识" class="headerlink" title="理论知识"></a>理论知识</h2><h3 id="期望最大化算法-EM-Algorithm"><a href="#期望最大化算法-EM-Algorithm" class="headerlink" title="期望最大化算法(EM Algorithm)"></a>期望最大化算法(EM Algorithm)</h3><p>在前面的若干讲义中，我们已经讲过了期望最大化算法（EM Algorithm），使用场景是对一个高斯混合模型进行拟合。在本章里面，我们要给出期望最大化算法的更广泛应用，并且演示如何应用于一个大系列的具有潜在变量的估计问题。我们的讨论从 Jensen 不等式（Jensen’s inequality）开始，这是一个非常有用的结论    。</p>
<h4 id="Jensen-不等式（Jensen’s-Inequality）"><a href="#Jensen-不等式（Jensen’s-Inequality）" class="headerlink" title="Jensen 不等式（Jensen’s Inequality）"></a>Jensen 不等式（Jensen’s Inequality）</h4><p>设 $f$ 为一个函数，其定义域为整个实数域。如果函数 $f$ 的二阶导数 $f′′(x) ≥ 0$ (其中的 $x \in R$)，则函数 $f$ 为一个凸函数。如果输入的为向量变量，那么这个函数就泛化了，这时候该函数的海森矩阵 $H$ 就是一个半正定矩阵。如果对于所有的 $x$ ，都有二阶导数 $f′′(x) &gt; 0$，那么我们称这个函数 $f$ 是严格凸函数。这样就可以用如下方式来表述 Jensen 不等式：</p>
<p><strong>定理：</strong>设 $f$ 是一个凸函数，且设 $X$ 是一个随机变量。则有：<br>$$ E[f(X)] ≥ f(EX)$$</p>
<p>即函数的期望大于等于期望的函数值。</p>
<a id="more"></a>
<p>此外，如果函数 $f$ 是严格凸函数，那么 $E[f(X)] = f(EX)$ 当且仅当 $X = E[X]$ 的概率为 1 的时候成立（例如 $X$ 是一个常数）。为了容易理解这个定理，可以参考下面的图：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img001.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>上图中，$f$ 是一个凸函数，在图中用实线表示。另外 $X$ 是一个随机变量，有 0.5 的概率取值为 $a$，另外有 0.5 的概率取值为 $b$ 。这样， $X$ 的期望值就在图中所示的 $a$ 和 $b$ 的中点位置。图中在 $y$ 轴上也标出了 $f(a)$, $f(b)$ 和 $f(E[X])$。接下来函数的期望值 $E[f(X)]$ 在 $y$ 轴上就处于 $f(a)$ 和 $f(b)$ 之间的中点的位置。如图中所示，在这个例子中由于 $f$ 是凸函数，很明显 $E[f(X)] ≥ f(EX)$。</p>
<p>当且仅当 $–f$ 是严格凸函数的时候，$f$ 是严格凹函数。Jensen 不等式也适用于凹函数 $f$ ，但不等式的方向要反过来，即对于凹函数，$E[f(X)] ≤ f(EX)$。</p>
<h4 id="期望最大化算法（EM-Algorithm）"><a href="#期望最大化算法（EM-Algorithm）" class="headerlink" title="期望最大化算法（EM Algorithm）"></a>期望最大化算法（EM Algorithm）</h4><p>假如我们有一个估计问题，其中训练样本集 ${x^{(1)}, …, x^{(m)}}$ 包含了 $m$ 个独立样本。我们用模型 $p(x, z)$ 对数据进行建模，拟合其参数，其似然函数如下所示：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img002.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>然而，确切地找到对参数 $θ$ 的最大似然估计可能会很难。此处的 $z^{(i)}$ 是一个潜在的随机变量；通常情况下，如果 $z^{(i)}$ 事先得到了，然后再进行最大似然估计，就容易多了。</p>
<p>这种环境下，使用期望最大化算法就能很有效地实现最大似然估计。明确地对似然函数进行最大化可能是很困难的，所以我们的策略就是使用一种替代，在 $E$ 步骤构建一个 $l$ 的下限，然后在 $M$ 步骤对这个下限进行优化。</p>
<p>对于每个 $i$，设 $Q_i$ 是某个对 $z$ 的分布，$Q_i(z) = 1$, $Q_i(z) ≥ 0$。则有下列各式：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img003.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>上面推导的最后一步使用了 Jensen 不等式。其中的 $f(x) = log x$ 是一个凹函数，因为其二阶导数 $f′′(x) = −1/x^2 &lt; 0$ 在整个定义域 $x \in R^+$ 上都成立。</p>
<p>此外，上式的求和中的单项：<img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img004.jpg?imageMogr2/thumbnail/!66p" alt="">是变量 $\frac {p(x^{(i)}, z^{(i)}; θ)} {Q_i(z^{(i)})}$ 关于 $z^{(i)}$ 的期望，其中 $z^{(i)}$ 是根据 $Q_i$ 给定的分布确定。然后利用 Jensen 不等式就得到了：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img005.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>其中上面的角标 $z^{(i)} ∼ Q_i$ 就表明这个期望是对于依据分布 $Q_i$ 来确定的 $z^{(i)}$ 的。这样就可以从等式 (2) 推导出等式 (3)。</p>
<p>接下来，对于任意的一个分布 $Q_i$ ，上面的等式 (3) 就给出了似然函数 $l(θ)$ 的下限。那么对于 $Q_i$  有很多种选择。我们应该选哪个呢？如果我们对参数 $θ$ 有某种当前的估计，很自然就可以设置这个下限为 $θ$ 这个值。也就是，针对当前的 $θ$ 值，我们令上面的不等式中的符号为等号。</p>
<p>为了让上面的限定值与 $θ$ 特定值联系紧密，我们需要上面推导过程中的 Jensen 不等式这一步中等号成立。要让这个条件成立，我们只需确保是在对一个常数值随机变量求期望。也就是需要：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img006.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>其中常数 $c$ 不依赖 $z^{(i)}$。要实现这一条件，只需满足：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img007.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>实际上，由于我们已知 $Σ Q_i(z^{(i)}) = 1$，这就进一步表明：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img008.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>因此，在给定 $x^{(i)}$ 和参数 $θ$ 的设置下，我们可以简单地把 $Q_i$ 设置为 $z^{(i)}$ 的后验分布。</p>
<p>接下来，对 $Q_i$ 的选择，等式 (3) 就给出了似然函数对数的一个下限，而似然函数正是我们要试图求最大值的。这就是 $E$ 步骤。接下来在算法的 $M$ 步骤中，就最大化等式 (3) 当中的方程，然后得到新的参数 $θ$。重复这两个步骤，就是完整的 $EM$ 算法，如下所示：</p>
<p>重复下列过程直到收敛:<br>$E-Step:$ 对每个 $i$，设<br><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img009.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>$M-Step:$ 设 </p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img011.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>怎么才能知道这个算法是否会收敛呢？设 $θ^{(t)}$ 和 $θ^{(t+1)}$ 是上面 $EM$ 迭代过程中的某两个参数。接下来我们就要证明 $l(θ^{(t)}) ≤ l(θ^{(t+1)})$，这就表明 $EM$ 迭代过程总是让似然函数对数单调递增。证明这个结论的关键就在于对 $Q_i$ 的选择中。在上面 $EM$ 迭代中，参数的起点设为 $θ^{(t)}$，我们就可以选择 $Q_i^{(t)}(z^{(i)}) := p(z^{(i)}|x^{(i)};θ^{(t)})$。</p>
<p>正如等式 (3) 的推导过程中所示，这样选择能保证 Jensen 不等式的等号成立，因此：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img012.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>参数 $θ^{(t+1)}$ 可以通过对上面等式中等号右侧进行最大化而得到。因此：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img013.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>上面的第一个不等式推自：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img014.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>上面这个不等式对于任意值的 $Q_i$ 和 $θ$ 都成立，尤其当 $Q_i = Q_i^{(t)}$ , $θ = θ^{(t+1)}$。要得到等式 (5)，我们要使 $θ^{(t+1)}$ 的选择能够保证：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img015.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>这个式子对 $θ^{(t+1)}$ 得到的值必须大于等于 $θ^{(t)}$ 得到的值。最后，推导等式 (6) 的这一步，因为在选择的时候就要保证 Jensen 不等式对 $θ^{(t)}$ 等号成立。因此，$EM$ 算法就能够导致似然函数的单调收敛。在我们推导 $EM$ 算法的过程中，我们要一直运行该算法到收敛。得到了上面的结果之后，可以使用一个合理的收敛检测来检查在成功的迭代之间的 $l(θ)$ 的增长是否小于某些容忍参数，如果 $EM$ 算法对 $l(θ)$ 的增大速度很慢，就声明收敛。</p>
<p><strong>备注：</strong>如果我们定义</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img017.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>通过我们之前的推导，就能知道 $l(θ) ≥ J(Q, θ)$。这样 $EM$ 算法也可看作是在 $J$ 上的坐标上升，其中 $E$ 步骤在 $Q$ 上对 $J$ 进行了最大化，然后 $M$ 步骤则在 $θ$ 上对 $J$ 进行最大化。</p>
<h4 id="高斯混合模型回顾（Mixture-of-Gaussians-Revisited）"><a href="#高斯混合模型回顾（Mixture-of-Gaussians-Revisited）" class="headerlink" title="高斯混合模型回顾（Mixture of Gaussians Revisited）"></a>高斯混合模型回顾（Mixture of Gaussians Revisited）</h4><p>有了对 $EM$ 算法的广义定义之后，我们就可以回顾一下之前的高斯混合模型问题，其中要拟合的参数有 $ \phi $, $μ$ 和 $Σ$。这里只给出在 $M$ 步骤中对 $\phi$ 和 $μ_j$ 进行更新的推导，关于 $Σ_j$ 的更新推导已略去。<br>$E$ 步骤很简单。还是按照上面的算法推导过程，只需要计算：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img018.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>这里面的 $Q_i(z^{(i)} = j)$ 表示的是在分布 $Q_i$上 $z^{(i)}$ 取值为 $j$ 的概率。<br>接下来在 $M$ 步骤，就要最大化关于参数 $\phi$, $μ$, $Σ$ 的值： </p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img019.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>先关于 $μ_l$ 来进行最大化，求关于 $μ_l$ 的偏导数得到：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img020.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>设上式为零，然后解出 $μ_l$ 就产生了更新规则：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img021.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>这个结果我们在之前的讲义中已经见到过了。再举一个例子，推导在 $M$ 步骤中参数 $\phi_j$ 的更新规则。把仅关于参数 $\phi_j$ 的表达式结合起来，就能发现只需要最大化下面的表达式：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img023.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>然而，还有一个附加的约束，即 $\phi_j$ 的和为1，因为其表示的是概率 $\phi_j = p(z^{(i)} = j;\phi)$。为了保证这个约束条件成立，即 $Σ^k_{j=1} \phi_j$ = 1，我们构建一个拉格朗日函数：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img024.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>其中的 $β$ 是拉格朗日乘数，求导得到：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img025.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>设导数为零，然后解方程得：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img027.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>也就是说，<img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img028.jpg?imageMogr2/thumbnail/!66p" alt="">结合约束条件 $Σ_j \phi_j = 1$，可以很容易地发现 $−β= Σ_{i=1}^m Σ_{j=1}^k  w_j^{(i)} = Σ_{i=1}^m 1=m$. (这里用到了条件 $w_j^{(i)} =Q_i(z^{(i)} = j)$。这样我们就得到了在 $M$ 步骤中对参数 $φ_j$ 进行更新的规则了：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note8-img029.jpg?imageMogr2/thumbnail/!66p" alt=""></p>
<p>接下来对 $M$ 步骤中对 $Σ_j$ 的更新规则的推导就很容易了。 </p>
<h3 id="因子分析（Factor-Analysis）"><a href="#因子分析（Factor-Analysis）" class="headerlink" title="因子分析（Factor Analysis）"></a>因子分析（Factor Analysis）</h3><p>如果有一个多个高斯模型混合而来的数据集 $x^{(i)} \in R^n$ ，那么就可以用期望最大化算法来对这个混合模型进行拟合。这种情况下，对于有充足数据的问题，我们通常假设可以从数据中识别出多个高斯模型结构。例如，如果我们的训练样本集合规模 $m$ 远远大于数据的维度 $n$ 就符合这种情况。</p>
<p>然后如果 $n$ 远远大于 $m$，即 $n ≫ m$。在这样的问题中，就可能用单独一个高斯模型来对数据建模都很难，更不用说多个高斯模型的混合模型了。由于 $m$ 个数据点所张开的只是一个 $n$ 维空间 $R^n$ 的低维度子空间，如果用高斯模型对数据进行建模，然后还是用常规的最大似然估计来估计平均值和方差，得到的则是：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note9-img001.jpg?imageMogr2/thumbnail/!50p" alt=""></p>
<p>我们会发现这里的 $Σ$ 是一个奇异矩阵。这也就意味着其逆矩阵 $Σ^{−1}$ 不存在，而 $1/|Σ|^{1/2} = 1/0$。 但这几个变量都还是需要的，要用来计算一个多元高斯分布的常规密度函数。还可以用另外一种方法，也就是对参数的最大似然估计会产生一个高斯分布，其概率分布在由样本数据所张成的仿射空间中，对应着一个奇异的协方差矩阵。</p>
<p>通常情况下，除非 $m$ 比 $n$ 大出相当多，否则最大似然估计得到的均值和方差都会很。尽管如此，我们还是希望能用已有的数据，拟合出一个合理的高斯模型，而且还希望能识别出数据中的某些有意义的协方差结构。在接下来的这一部分内容里，我们首先回顾一下对 $Σ$ 的两个可能的约束，这两个约束条件能让我们使用小规模数据来拟合 $Σ$，但不能就我们的问题给出让人满意的解。然后接下来我们讨论了高斯模型的一些特点，也就是如何找到高斯模型的边界和条件分布。最后，我们会讲一下因子分析模型以及对应的期望最大化算法。</p>
<h4 id="Σ-的约束条件（Restrictions-of-Σ-）"><a href="#Σ-的约束条件（Restrictions-of-Σ-）" class="headerlink" title="$Σ$ 的约束条件（Restrictions of $Σ$）"></a>$Σ$ 的约束条件（Restrictions of $Σ$）</h4><p>如果我们没有充足的数据来拟合一个完整的协方差矩阵，就可以对矩阵空间 $Σ$ 给出某些约束条件。例如，我们可以选择去拟合一个对角的协方差矩阵 $Σ$。这样，很容易就能验证这样的一个协方差矩阵的最大似然估计可以由对角矩阵 $Σ$ 满足：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note9-img002.jpg?imageMogr2/thumbnail/!75p" alt=""></p>
<p>$Σ_{jj}$ 就是对数据中第 $j$ 个坐标位置的方差值的经验估计。</p>
<p>高斯模型的密度的形状是椭圆形的。对角线矩阵 $Σ$ 对应的就是椭圆长轴对齐的高斯模型。有时候，我们还要对这个协方差矩阵给出进一步的约束，不仅设为对角的，还要求所有对角元素都相等。这时候，就有 $Σ = σ^2I$，其中 $σ^2$ 是我们控制的参数。对这个 $σ^2$ 的最大似然估计则为：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note9-img003.jpg?imageMogr2/thumbnail/!75p" alt=""></p>
<p>这种模型对应的是密度函数为圆形轮廓的高斯模型（在二维空间也就是平面中是圆，在更高维度当中就是球或者超球）。</p>
<p>如果我们对数据要拟合一个完整的，不受约束的协方差矩阵 $Σ$，就必须满足 $m ≥ n + 1$，这样才使得对 $Σ$ 的最大似然估计不是奇异矩阵。在上面提到的两个约束条件之下，只要 $m ≥ 2$，我们就能获得非奇异的 $Σ$。<br>然而，将 $Σ$ 限定为对角矩阵，也就意味着对数据中不同坐标的 $x_i$，$x_j$建模都将是不相关且互相独立的。通常，还是从样本数据里面获得某些有趣的相关信息结构比较好。如果使用上面对 $Σ$ 的某一种约束，就可能没办法获取这些信息了。<br>在本章讲义里面，我们会提到因子分析模型，这个模型使用的参数比对角矩阵 $Σ$ 更多，而且能从数据中获得某些相关性信息，但也不能对完整的协方差矩阵进行拟合。</p>
<h4 id="多元高斯模型的边界和条件（Marginals-and-conditionals-of-Gaussians）"><a href="#多元高斯模型的边界和条件（Marginals-and-conditionals-of-Gaussians）" class="headerlink" title="多元高斯模型的边界和条件（Marginals and conditionals of Gaussians）"></a>多元高斯模型的边界和条件（Marginals and conditionals of Gaussians）</h4><p>在讲解因子分析之前，我们要先说一下联合多元高斯分布下的随机变量的条件和边界分布，假如我们有一个值为向量的随机变量：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note9-img004.jpg?imageMogr2/thumbnail/!75p" alt=""></p>
<p>其中 $x_1 \in R^r$,  $x_2 \in R^s$，因此  $x \in R^{r+s}$。设 $x ∼ N(μ,Σ)$, 即以 $μ$ 和 $Σ$ 为参数的正态分布，则这两个参数为：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note9-img005.jpg?imageMogr2/thumbnail/!75p" alt=""></p>
<p>其中， $μ_1 \in R^r$, $μ_2 \in R^s$， $Σ_{11} \in R^{r×r}$, $Σ_{12} \in R^{r×s}$，以此类推。由于协方差矩阵是对称的，所以有 $Σ_{12} = Σ^T_{21}$. </p>
<p>基于我们的假设，$x_1$ 和 $x_2$ 是联合多元高斯分布。那么 $x_1$  的边界分布是什么？不难看出 $x_1$  的期望 $E[x_1] = μ_1$ ，而协方差 $Cov(x_1) = E[(x_1 − μ_1)(x_1 − μ_1)] = Σ_{11}$ 。接下来为了验证后面这一项成立，要用 $x_1$ 和 $x_2$ 的联合方差的概念：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note9-img006.jpg?imageMogr2/thumbnail/!75p" alt=""></p>
<p>在上面的最后两行中，匹配矩阵的左上方子阵，就可以得到结果了。<br>高斯分布的边界分布本身也是高斯分布，所以我们就可以给出一个正态分布 $x_1 ∼ N (μ_1, Σ_{11})$ 来作为 $x_1$ 的边界分布。<br>此外，我们还可以提出另一个问题，给定 $x_2$ 的情况下 $x_1$ 的条件分布是什么呢？通过参考多元高斯分布的定义，就能得到这个条件分布 $x_1|x_2 ∼ N (μ_{1|2}, Σ_{1|2})$为：</p>
<p><img src="http://otceoztx6.bkt.clouddn.com/cs229-note9-img007.jpg?imageMogr2/thumbnail/!75p" alt=""></p>
<p>在下一节对因子分析模型的讲解中，上面这些公式就很有用了，可以帮助寻找高斯分布的条件和边界分布。</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/公开课笔记/" rel="tag"># 公开课笔记</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/08/19/cs229-12/" rel="next" title="第十二集 K-Means算法">
                <i class="fa fa-chevron-left"></i> 第十二集 K-Means算法
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/08/30/cs229-14/" rel="prev" title="第十四集 主成分分析法">
                第十四集 主成分分析法 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Zhenyu Zhang" />
          <p class="site-author-name" itemprop="name">Zhenyu Zhang</p>
           
              <p class="site-description motion-element" itemprop="description">Survival with technology<br/>And living with art</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">45</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">32</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#理论知识"><span class="nav-number">1.</span> <span class="nav-text">理论知识</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#期望最大化算法-EM-Algorithm"><span class="nav-number">1.1.</span> <span class="nav-text">期望最大化算法(EM Algorithm)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Jensen-不等式（Jensen’s-Inequality）"><span class="nav-number">1.1.1.</span> <span class="nav-text">Jensen 不等式（Jensen’s Inequality）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#期望最大化算法（EM-Algorithm）"><span class="nav-number">1.1.2.</span> <span class="nav-text">期望最大化算法（EM Algorithm）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#高斯混合模型回顾（Mixture-of-Gaussians-Revisited）"><span class="nav-number">1.1.3.</span> <span class="nav-text">高斯混合模型回顾（Mixture of Gaussians Revisited）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#因子分析（Factor-Analysis）"><span class="nav-number">1.2.</span> <span class="nav-text">因子分析（Factor Analysis）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Σ-的约束条件（Restrictions-of-Σ-）"><span class="nav-number">1.2.1.</span> <span class="nav-text">$Σ$ 的约束条件（Restrictions of $Σ$）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#多元高斯模型的边界和条件（Marginals-and-conditionals-of-Gaussians）"><span class="nav-number">1.2.2.</span> <span class="nav-text">多元高斯模型的边界和条件（Marginals and conditionals of Gaussians）</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zhenyu Zhang</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  






  





  

  

  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  


  

  

</body>
</html>
